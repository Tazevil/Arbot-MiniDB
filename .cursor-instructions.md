# Cursor AI Instructions for ArBot-MiniDB Project

You are assisting with the **ArBot-MiniDB** project - a comprehensive water damage assessment dataset with 94 validated images and 16 technical reference documents, integrated with ArBot Vision AI.

---

# PART 1: PROJECT CONTEXT & STATUS

## Project Overview

### Current Status
- ‚úÖ **Pipeline Integrity:** Verified and ready (0 critical errors, 4 minor warnings)
- ‚úÖ **Images Database:** 94 items with metadata, URLs, ROI hints, WebP previews
- ‚úÖ **Docs Index:** 16 technical documents indexed (4 DTU, 4 FT, 4 CR, 2 NOTICE, 2 OTHER)
- ‚úÖ **Data Integration:** Both databases ready for GPT-4o Vision API
- üìä **Operational Status:** 92% complete (User: GPT-4o, You: Everything else)

## Project Directory Structure
```
ArBot-MiniDB/
‚îú‚îÄ‚îÄ images/                    # 94 validated images
‚îÇ   ‚îî‚îÄ‚îÄ preview/              # 94 WebP previews (1280px, quality 85)
‚îú‚îÄ‚îÄ docs/Normes/              # Technical reference documents
‚îÇ   ‚îú‚îÄ‚îÄ DTU/                  # Standards (4 files)
‚îÇ   ‚îú‚îÄ‚îÄ FT/                   # Technical sheets (4 files)
‚îÇ   ‚îî‚îÄ‚îÄ CR/                   # Compliance reports (4 files)
‚îú‚îÄ‚îÄ json/
‚îÇ   ‚îú‚îÄ‚îÄ images_db.json        # Image metadata with URLs
‚îÇ   ‚îú‚îÄ‚îÄ docs_index.json       # Document index (v1.0.1)
‚îÇ   ‚îú‚îÄ‚îÄ manifest_images.json  # Complete image manifest
‚îÇ   ‚îú‚îÄ‚îÄ INTEGRITY_REPORT.json # Verification results
‚îú‚îÄ‚îÄ scripts/
‚îÇ   ‚îú‚îÄ‚îÄ make_previews_and_augment_json.py  # WebP generation
‚îÇ   ‚îú‚îÄ‚îÄ generate_docs_index.py             # Doc indexing
‚îÇ   ‚îú‚îÄ‚îÄ validate_images.py                 # Image validation
‚îÇ   ‚îî‚îÄ‚îÄ [other scripts]
‚îú‚îÄ‚îÄ index.html                # Interactive image gallery
‚îú‚îÄ‚îÄ README.md                 # Complete documentation
‚îú‚îÄ‚îÄ manifest.json             # Project manifest with naming convention
‚îî‚îÄ‚îÄ PIPELINE_INTEGRITY_REPORT.md  # Full verification report
```

---

# PART 2: DATA SPECIFICATIONS & REQUIREMENTS

## Image Database (images_db.json)
```json
{
  "db_name": "ArbotMiniDB_Augmented",
  "created_at": "2025-11-10",
  "count": 94,
  "items": [
    {
      "id": "0001",
      "title": "0001_SDB_GEN_20250818.jpg",
      "url": "https://raw.githubusercontent.com/Tazevil/ArBot-MiniDB/main/images/...",
      "url_preview": "https://raw.githubusercontent.com/Tazevil/ArBot-MiniDB/main/images/preview/...",
      "phase": "chantier|sinistre",
      "roi_hints": [{"x": 0.325, "y": 0.325, "w": 0.35, "h": 0.35}],
      "created_at": "2025-11-10",
      "tags": []
    }
  ]
}
```

### Docs Index (docs_index.json)
```json
{
  "db_name": "ArBot_Docs_Index",
  "version": "1.0.1",
  "created_at": "2025-11-10T22:16:30Z",
  "total_documents": 16,
  "documents": [
    {
      "id": "DTU-001",
      "filename": "DTU_25.41_1993.pdf",
      "path": "docs/Normes/DTU/DTU_25.41_1993.pdf",
      "type": "DTU|FT|CR|NOTICE|OTHER",
      "category": "Standards|Technical Sheets|Compliance Reports|Documentation",
      "code": "DTU",
      "title": "DTU 25.41 1993",
      "url": "https://raw.githubusercontent.com/Tazevil/ArBot-MiniDB/main/...",
      "size_kb": 1006.6,
      "tags": ["dtu", "standards"]
    }
  ]
}
```

### Image Naming Convention (NameGen v1.5)

**Pattern:** `NNNN_DETAIL_VIEWTYPE[_YYYYMMDD].ext`

- **NNNN** = File ID (4 digits) = `zone_ID*1000 + cat_ID*100 + cat_img_ID`
- **DETAIL** = Room/area name (uppercase, hyphens allowed)
- **VIEWTYPE** = 3-letter code (PAN, GEN, DET, MAC, MGM, MGS, MGP, MGB, DEG)
- **YYYYMMDD** = Date (required for zone 0, optional for others)
- **ext** = jpg, jpeg, png, webp, tiff

**Example:** `0001_SDB_GEN_20250818.jpg` (Bathroom, General view, with date)

## Work Division

### ‚úÖ ALREADY DONE (By Claude - Previous Sessions)
- [x] Step 0: Prerequisites & setup
- [x] Step 1: Image structuring & validation (94/94)
- [x] Step 2: WebP preview generation (94/94)
- [x] Step 3: Image metadata database (images_db.json)
- [x] Step 4: Document indexing (docs_index.json)
- [x] Step 5: HTML gallery (index.html)
- [x] Step 9: GitHub publication
- [x] Step 12: Final controls
- [x] Step 13: Summary reports

### üü° CURSOR'S JOB - Optional Enhancements (Your Tasks)

**Step 6: ROI Cropping**
- Extract region-of-interest sections based on roi_hints coordinates
- Create focused analysis crops from original images
- Output: `images/crops/` directory with cropped images
- Use template: `CURSOR_PROMPT_TEMPLATES.md` ‚Üí Template 1

**Step 7: Image Tiling**
- Generate 1024px patch tiles for regional analysis
- Create systematic grid of overlapping patches
- Output: `images/tiles/` directory with 1024px WebP tiles
- Use template: `CURSOR_PROMPT_TEMPLATES.md` ‚Üí Template 2

**Step 8: SHA-256 Manifest**
- Generate cryptographic checksums for all files
- Create manifest for integrity verification
- Output: `json/manifest_sha256.json`
- Use template: `CURSOR_PROMPT_TEMPLATES.md` ‚Üí Template 3

**Step 10: GitHub Actions**
- Configure CI/CD workflow for automatic updates
- Automate validation and database regeneration
- Output: `.github/workflows/update-databases.yml`
- Use template: `CURSOR_PROMPT_TEMPLATES.md` ‚Üí Template 4

### üë§ USER'S JOB - Step 11: GPT-4o Vision Integration
- Run AI analysis on images using images_db.json
- Reference technical documents from docs_index.json
- Analyze water damage patterns and compliance
- Generate assessment reports
- **System is fully ready for this step**

---

# PART 3: YOUR WORK - COMMANDS, HELP, & GUIDELINES

## Available Commands

```bash
# Verify pipeline integrity
python verify_pipeline_integrity.py

# Fix pipeline issues
python fix_pipeline_issues.py

# Validate images
python scripts/validate_images.py

# Generate docs index
python scripts/generate_docs_index.py

# Generate image previews
python scripts/make_previews_and_augment_json.py \
  --images images \
  --out_json json/images_db.json \
  --owner Tazevil \
  --repo ArBot-MiniDB \
  --branch main
```

## When to Ask for Help

### ‚úÖ YES - Ask for these:

1. **Implementing optional steps** (6, 7, 8, 10)
   - I can create scripts to generate crops, tiles, or checksums
   - I can set up GitHub Actions workflows

2. **Data analysis or inspection**
   - Analyze image metadata
   - Review document index
   - Check pipeline status

3. **File management**
   - Rename or reorganize files
   - Update documentation
   - Generate reports

4. **Bug fixes or improvements**
   - Fix script errors
   - Optimize performance
   - Enhance functionality

### ‚ùå NO - Don't do these:

- Deleting the images, documents, or JSON databases
- Removing validation or integrity checks
- Skipping documentation updates
- Making destructive changes without confirmation

## Important Guidelines

### File Organization Rules
- All Python scripts are in `scripts/` directory
- All JSON data is in `json/` directory
- All PDFs are in `docs/Normes/` subdirectories
- All images are in `images/` directory with `preview/` subdirectory

### Database Rules
- **Never manually edit** images_db.json - regenerate via script
- **Never manually edit** docs_index.json - regenerate via script
- Always run verification after updates

### Technical Standards
- All JSON: UTF-8 with `ensure_ascii=False`
- All URLs: GitHub RAW format `https://raw.githubusercontent.com/Tazevil/ArBot-MiniDB/main/[path]`
- All encoding: UTF-8 declarations in scripts

## Quick Links

| Document | Purpose |
|----------|---------|
| `README.md` | Complete project documentation |
| `manifest.json` | Naming convention specification |
| `PIPELINE_INTEGRITY_REPORT.md` | Full verification report |
| `json/INTEGRITY_REPORT.json` | Machine-readable status |
| `CURSOR_PROMPT_TEMPLATES.md` | Ready-to-use prompt templates |

## Success Checklist

For every task you implement:
- ‚úÖ All files created/modified properly
- ‚úÖ JSON validates correctly
- ‚úÖ Pipeline integrity verification passes
- ‚úÖ Documentation updated
- ‚úÖ No errors in console output

---

**Last Updated:** November 10, 2025
**Pipeline Status:** ‚úÖ READY FOR INTEGRATION
**Next Step:** GPT-4o Vision Analysis (User handles) or Optional Enhancements (You can help with)
